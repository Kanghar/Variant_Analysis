\documentclass[12pt]{article}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Package
\usepackage{polski}
\usepackage[cp1250]{inputenc}
\usepackage{fancyvrb}
\usepackage{setspace}
\usepackage[margin=2.5cm]{geometry}
\usepackage{graphicx}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Parametry dokumentu
\linespread{1.5}%1.5 odstêpu miedzy liniami



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\centering
{\fontsize{20}{20}\selectfont Uniwersytet Przyrodniczy we Wroc³awiu}\\
{\fontsize{18}{18}\selectfont Wydzia³ Biologii i Hodowli Zwierz¹t}\\
{\fontsize{16}{16}\selectfont Kierunek: Bioinformatyka}\\
{\fontsize{16}{16}\selectfont Studia stacjonarne pierwszego stopnia}\\

\vspace{3cm}

{\fontsize{20}{20}\selectfont Dawid Sikorski}\\
{\fontsize{14}{14}\selectfont 110944}\\

\vspace{2.5cm}

\textbf{\fontsize{24}{24}\selectfont Analiza zmiennoœci genetycznej cz³owieka na podstawie danych z sekwencjonowania nowej generacji}\\
{\fontsize{18}{18}\selectfont Analysis of human genetic variability based on data from next-generation sequencing}\\

\vspace{3cm}

\flushright
{\fontsize{14}{14}\selectfont Praca wykonana pod kierunkiem}\\
{\fontsize{14}{14}\selectfont dr. Tomasz Suchocki}\\
{\fontsize{14}{14}\selectfont Katedra Genetyki}\\

\vspace{2cm}
\centering
{\fontsize{14}{14}\selectfont Wroc³aw, 2019}\\  

\newpage
 


\flushleft
\vspace{10cm} 
\textbf{\fontsize{14}{14}\selectfont Oœwiadczenie opiekuna pracy} \\
Oœwiadczam, ¿e niniejsza praca zosta³a przygotowana pod moim kierownictwem i stwierdzam, ¿e spe³nia ona warunki do przedstawienia jej w postêpowaniu o nadanie tytu³u zawodowego.

\vspace{3cm}

Data\hspace{10cm} Podpis opiekuna pracy

\vspace{7cm} 

\textbf{\fontsize{14}{14}\selectfont Oœwiadczenie autora pracy}
Oœwiadczam, ¿e niniejsza praca dyplomowa zosta³a napisana przeze mnie samodzielnie i nie zawiera treœci uzyskanych w sposób niezgodny z obowi¹zuj¹cymi przepisami ani te¿ nie by³a wczeœniej przedmiotem procedur zwi¹zanych z uzyskaniem tytu³u zawodowego w wy¿szej uczelni.

\vspace{3cm}

Data\hspace{10cm} Podpis opiekuna pracy

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\tableofcontents
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

\section{Wstêp}
Celem pracy jest analiza zmiennoœci genetycznej cz³owieka. Praca omawia zale¿noœci pomiêdzy iloœci¹ wariantów a ich lokalizacj¹ w kariotypie oraz konsekwencj¹ mutacji, a tak¿e rozwa¿ania na temat samych konsekwencji mutacji?
\subsection{Baza danych}
Niniejsza praca oparta jest na zestawie danych pochodz¹cych z gnomAD(genome aggregation database). Jest to baza danych opracowana przez miêdzynarodow¹ koalicjê badaczy, w celu agregowania i ujednolicenia danych dotycz¹cych szerokiej gamy projektów sekwencjonowania genomu oraz udostêpniania tych danych dla spo³ecznoœci naukowej. \\
\vspace{0.5cm}
Baza danych obejmuje 125 748 sekwencji egzomowych oraz 15 708 sekwencji ca³ego genomu od niepowi¹zanych osobników zsekwencjonowanych w ramach ró¿nych badañ genetycznych specyficznych dla choroby i populacji.

U¿yty zestaw danych zawiera informacje o wariancjach z 22 chromosomów autosomalnych.
liczba rekordów
119794797


\subsection{Zawartoœæ pracy?}
Co znajduje siê w poszczególnych sekcjach pracy
\subsection{U¿yte oprogramowanie?}

\section{Przetwarzanie danych}
Variant Call Format(VCF) jest to specyficzny format plików tekstowych powszechnie u¿ywany w bioinformatyce do przechowywania danych genomu dotycz¹cych mutacji. Format zosta³ opracowany wraz z rozpoczêciem projektów sekwencjonowania genomów na du¿¹ skalê, takich jak 1000 Genomes Project. 

\subsection{Specyfikacja formatu VCF}
Nag³ówek rozpoczyna plik i opisuje jego zawartoœæ. Linie nag³ówka s¹ oznaczone jako \# . Specjalne s³owa kluczowe w nag³ówku s¹ oznaczone {\# \#} . Zawieraj¹ one informacje o pochodzeniu pliku, gatunku oraz objaœniaj¹ u¿yte w nim skróty.
\begin{figure}[!htbp] 
  \centering
    \includegraphics[scale=0.66]{VCF_header.PNG}
    \caption{Fragment nag³ówka z u¿ytego zestawu danych}
\end{figure}

\begin{tabular}{|c|c|c|}
 \hline
 &Nazwa&Krótki opis.\\  \hline
1&Chrom&Numer chromosomu, na którym znajduje siê dany wariant. \\ \hline
2&POS&Pozycja zmiany w sekwencji. \\  \hline
3&ID&Identyfikator zmiany.  \\  \hline
4&REF&Allel referencyjny, czyli allel wed³ug genomu referencyjnego.  \\  \hline
5&ALT&Allel alternatywny, czyli allel jaki pojawi³ siê u osobnika o danym wariancie.  \\  \hline
6&QUAL&Wynik jakoœci allelu?  \\  \hline
7&FILTER&Zawiera informacje na temat których filtrów dany rekord nie przeszed³. \\  \hline
8&INFO&Lista zawieraj¹ca zastawy klucz-wartoœæ, opisuj¹ca wariant. \\  \hline
\end{tabular} \\
\vspace{1cm}

Pole info zawiera szczegó³owe informacje rekordu.
Wykorzystane w pracy kategorie to:

AC=3, liczba alleli w genotypach
AN=2654, ca³kowita liczba alleli w u¿ytych genotypach
AF=1.13037e-03, czêstoœæ wystêpowania danego allelu
vep, zawieraj¹cy szczegó³owe informacje na temat wariantu takie jak: \\
Konsekwencja mutacji, wp³yw na produkt, identyfikatory dla biologicznych baz danych(NCBI oraz ENSEMBL) i wiele innych, które nie zosta³y u¿yte na potrzeby pracy.

\begin{figure}[!htbp] 
  \centering
    \includegraphics[scale=0.78]{VCF_1stline.PNG}
    \caption{Fragment pliku przedstawiaj¹cy dane}
\end{figure}

\subsection{Przetwarzanie pliku}
Z racji du¿ego rozmiaru pliku oraz zawartoœci niepotrzebnych informacji, plik ten musia³ zostaæ odpowiednio przygotowany zanim zostanie u¿yty do przeprowadzenia analizy. \\ 
W tym celu zosta³ stworzony krótki skrypt w Pythonie, którego zadaniem by³a ekstrakcja kluczowych dla analizy danych.


\subsection{Kod skryptu u¿ytego do wydobycia danych}
\begin{verbatim}
with open('/home/dawid/Pulpit/Variant_analysis_data/gnomad.exomes.r2.1.sites.chr21.vcf','r') as input_file, open('/home/dawid/Pulpit/Variant_analysis_data/data_1.txt','w') as output_file:
#with open('/media/dawid/Wirusy/Variant_analysis_data/gnomad.exomes.r2.1.sites.vcf','r') as input_file, open('/home/dawid/Pulpit/Variant_analysis_data/data_1.txt','w') as output_file:
    for line in input_file:
        if line[0][0] == '#':
            continue
        line = line.split('\t')
        temp = [line[i] for i in [0,1,3,4]]
        info = line[7].split(';')
        info[0] = info[0][len('AC='):]
        info[1] = info[1][len('AN='):]
        info[2] = info[2][len('AF='):]
        vep = info[-1].split(',')
        if line[6] == 'PASS':
            for ele in vep:
                vep_info = ele.strip().split('|')
                vep_info = [vep_info[i] for i in [1,2,3,4,5,6,22]]
                output_file.write('\t'.join(temp+info[0:3]+vep_info)+'\n')    

\end{verbatim}


\section{Analiza danych}
\subsection{Warianty dotycz¹ce bia³ek}
wykres1 \\
wykres2 \\

\subsection{Wszystkie warianty genomu}
wykres1 \\
wykres2 \\

\section{Bibliografia}
\begin{verbatim}
https://en.wikipedia.org/wiki/Variant_Call_Format
\end{verbatim}

\end{document}